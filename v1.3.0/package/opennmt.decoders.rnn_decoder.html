

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>opennmt.decoders.rnn_decoder module &mdash; OpenNMT-tf 1.3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="opennmt.decoders.self_attention_decoder module" href="opennmt.decoders.self_attention_decoder.html" />
    <link rel="prev" title="opennmt.decoders.decoder module" href="opennmt.decoders.decoder.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> OpenNMT-tf
          

          
            
            <img src="../_static/logo-alpha.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tokenization.html">Tokenization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serving.html">Serving</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="opennmt.html">opennmt package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="opennmt.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="opennmt.decoders.html">opennmt.decoders package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="opennmt.decoders.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.encoders.html">opennmt.encoders package</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.inputters.html">opennmt.inputters package</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.layers.html">opennmt.layers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.models.html">opennmt.models package</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.tokenizers.html">opennmt.tokenizers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="opennmt.utils.html">opennmt.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="opennmt.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenNMT-tf</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="opennmt.html">opennmt package</a> &raquo;</li>
        
          <li><a href="opennmt.decoders.html">opennmt.decoders package</a> &raquo;</li>
        
      <li>opennmt.decoders.rnn_decoder module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-opennmt.decoders.rnn_decoder">
<span id="opennmt-decoders-rnn-decoder-module"></span><h1>opennmt.decoders.rnn_decoder module<a class="headerlink" href="#module-opennmt.decoders.rnn_decoder" title="Permalink to this headline">¶</a></h1>
<p>Define RNN-based decoders.</p>
<dl class="class">
<dt id="opennmt.decoders.rnn_decoder.RNNDecoder">
<em class="property">class </em><code class="descclassname">opennmt.decoders.rnn_decoder.</code><code class="descname">RNNDecoder</code><span class="sig-paren">(</span><em>num_layers</em>, <em>num_units</em>, <em>bridge=None</em>, <em>cell_class=&lt;class 'tensorflow.python.ops.rnn_cell_impl.LSTMCell'&gt;</em>, <em>dropout=0.3</em>, <em>residual_connections=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#RNNDecoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.RNNDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="opennmt.decoders.decoder.html#opennmt.decoders.decoder.Decoder" title="opennmt.decoders.decoder.Decoder"><code class="xref py py-class docutils literal"><span class="pre">opennmt.decoders.decoder.Decoder</span></code></a></p>
<p>A basic RNN decoder.</p>
<dl class="method">
<dt id="opennmt.decoders.rnn_decoder.RNNDecoder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>num_layers</em>, <em>num_units</em>, <em>bridge=None</em>, <em>cell_class=&lt;class 'tensorflow.python.ops.rnn_cell_impl.LSTMCell'&gt;</em>, <em>dropout=0.3</em>, <em>residual_connections=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#RNNDecoder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.RNNDecoder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the decoder parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_layers</strong> – The number of layers.</li>
<li><strong>num_units</strong> – The number of units in each layer.</li>
<li><strong>bridge</strong> – A <a class="reference internal" href="opennmt.layers.bridge.html#opennmt.layers.bridge.Bridge" title="opennmt.layers.bridge.Bridge"><code class="xref py py-class docutils literal"><span class="pre">opennmt.layers.bridge.Bridge</span></code></a> to pass the encoder state
to the decoder.</li>
<li><strong>cell_class</strong> – The inner cell class or a callable taking <code class="xref py py-obj docutils literal"><span class="pre">num_units</span></code> as
argument and returning a cell.</li>
<li><strong>dropout</strong> – The probability to drop units in each layer output.</li>
<li><strong>residual_connections</strong> – If <code class="docutils literal"><span class="pre">True</span></code>, each layer input will be added to its
output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="opennmt.decoders.rnn_decoder.RNNDecoder.decode">
<code class="descname">decode</code><span class="sig-paren">(</span><em>inputs</em>, <em>sequence_length</em>, <em>vocab_size=None</em>, <em>initial_state=None</em>, <em>sampling_probability=None</em>, <em>embedding=None</em>, <em>output_layer=None</em>, <em>mode='train'</em>, <em>memory=None</em>, <em>memory_sequence_length=None</em>, <em>return_alignment_history=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#RNNDecoder.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.RNNDecoder.decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="opennmt.decoders.rnn_decoder.RNNDecoder.dynamic_decode">
<code class="descname">dynamic_decode</code><span class="sig-paren">(</span><em>embedding</em>, <em>start_tokens</em>, <em>end_token</em>, <em>vocab_size=None</em>, <em>initial_state=None</em>, <em>output_layer=None</em>, <em>maximum_iterations=250</em>, <em>mode='infer'</em>, <em>memory=None</em>, <em>memory_sequence_length=None</em>, <em>dtype=None</em>, <em>return_alignment_history=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#RNNDecoder.dynamic_decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.RNNDecoder.dynamic_decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="opennmt.decoders.rnn_decoder.RNNDecoder.dynamic_decode_and_search">
<code class="descname">dynamic_decode_and_search</code><span class="sig-paren">(</span><em>embedding</em>, <em>start_tokens</em>, <em>end_token</em>, <em>vocab_size=None</em>, <em>initial_state=None</em>, <em>output_layer=None</em>, <em>beam_width=5</em>, <em>length_penalty=0.0</em>, <em>maximum_iterations=250</em>, <em>mode='infer'</em>, <em>memory=None</em>, <em>memory_sequence_length=None</em>, <em>dtype=None</em>, <em>return_alignment_history=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#RNNDecoder.dynamic_decode_and_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.RNNDecoder.dynamic_decode_and_search" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="opennmt.decoders.rnn_decoder.AttentionalRNNDecoder">
<em class="property">class </em><code class="descclassname">opennmt.decoders.rnn_decoder.</code><code class="descname">AttentionalRNNDecoder</code><span class="sig-paren">(</span><em>num_layers</em>, <em>num_units</em>, <em>bridge=None</em>, <em>attention_mechanism_class=&lt;class 'tensorflow.contrib.seq2seq.python.ops.attention_wrapper.LuongAttention'&gt;</em>, <em>output_is_attention=True</em>, <em>cell_class=&lt;class 'tensorflow.python.ops.rnn_cell_impl.LSTMCell'&gt;</em>, <em>dropout=0.3</em>, <em>residual_connections=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#AttentionalRNNDecoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.AttentionalRNNDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#opennmt.decoders.rnn_decoder.RNNDecoder" title="opennmt.decoders.rnn_decoder.RNNDecoder"><code class="xref py py-class docutils literal"><span class="pre">opennmt.decoders.rnn_decoder.RNNDecoder</span></code></a></p>
<p>A RNN decoder with attention.</p>
<p>It simple overrides the cell construction to add an attention wrapper.</p>
<dl class="method">
<dt id="opennmt.decoders.rnn_decoder.AttentionalRNNDecoder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>num_layers</em>, <em>num_units</em>, <em>bridge=None</em>, <em>attention_mechanism_class=&lt;class 'tensorflow.contrib.seq2seq.python.ops.attention_wrapper.LuongAttention'&gt;</em>, <em>output_is_attention=True</em>, <em>cell_class=&lt;class 'tensorflow.python.ops.rnn_cell_impl.LSTMCell'&gt;</em>, <em>dropout=0.3</em>, <em>residual_connections=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#AttentionalRNNDecoder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.AttentionalRNNDecoder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the decoder parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_layers</strong> – The number of layers.</li>
<li><strong>num_units</strong> – The number of units in each layer.</li>
<li><strong>bridge</strong> – A <a class="reference internal" href="opennmt.layers.bridge.html#opennmt.layers.bridge.Bridge" title="opennmt.layers.bridge.Bridge"><code class="xref py py-class docutils literal"><span class="pre">opennmt.layers.bridge.Bridge</span></code></a> to pass the encoder state
to the decoder.</li>
<li><strong>attention_mechanism_class</strong> – A class inheriting from
<code class="docutils literal"><span class="pre">tf.contrib.seq2seq.AttentionMechanism</span></code> or a callable that takes
<code class="docutils literal"><span class="pre">(num_units,</span> <span class="pre">memory,</span> <span class="pre">memory_sequence_length)</span></code> as arguments and returns
a <code class="docutils literal"><span class="pre">tf.contrib.seq2seq.AttentionMechanism</span></code>.</li>
<li><strong>output_is_attention</strong> – If <code class="docutils literal"><span class="pre">True</span></code>, the final decoder output (before logits)
is the output of the attention layer. In all cases, the output of the
attention layer is passed to the next step.</li>
<li><strong>cell_class</strong> – The inner cell class or a callable taking <code class="xref py py-obj docutils literal"><span class="pre">num_units</span></code> as
argument and returning a cell.</li>
<li><strong>dropout</strong> – The probability to drop units in each layer output.</li>
<li><strong>residual_connections</strong> – If <code class="docutils literal"><span class="pre">True</span></code>, each layer input will be added to its
output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="opennmt.decoders.rnn_decoder.MultiAttentionalRNNDecoder">
<em class="property">class </em><code class="descclassname">opennmt.decoders.rnn_decoder.</code><code class="descname">MultiAttentionalRNNDecoder</code><span class="sig-paren">(</span><em>num_layers</em>, <em>num_units</em>, <em>attention_layers=None</em>, <em>attention_mechanism_class=&lt;class 'tensorflow.contrib.seq2seq.python.ops.attention_wrapper.LuongAttention'&gt;</em>, <em>cell_class=&lt;class 'tensorflow.python.ops.rnn_cell_impl.LSTMCell'&gt;</em>, <em>dropout=0.3</em>, <em>residual_connections=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#MultiAttentionalRNNDecoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.MultiAttentionalRNNDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#opennmt.decoders.rnn_decoder.RNNDecoder" title="opennmt.decoders.rnn_decoder.RNNDecoder"><code class="xref py py-class docutils literal"><span class="pre">opennmt.decoders.rnn_decoder.RNNDecoder</span></code></a></p>
<p>A RNN decoder with multi-attention.</p>
<p>This decoder can attend the encoder outputs after multiple RNN layers using
one or multiple attention mechanisms. Additionally, the cell state of this
decoder is not initialized from the encoder state (i.e. a
<a class="reference internal" href="opennmt.layers.bridge.html#opennmt.layers.bridge.ZeroBridge" title="opennmt.layers.bridge.ZeroBridge"><code class="xref py py-class docutils literal"><span class="pre">opennmt.layers.bridge.ZeroBridge</span></code></a> is imposed).</p>
<dl class="method">
<dt id="opennmt.decoders.rnn_decoder.MultiAttentionalRNNDecoder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>num_layers</em>, <em>num_units</em>, <em>attention_layers=None</em>, <em>attention_mechanism_class=&lt;class 'tensorflow.contrib.seq2seq.python.ops.attention_wrapper.LuongAttention'&gt;</em>, <em>cell_class=&lt;class 'tensorflow.python.ops.rnn_cell_impl.LSTMCell'&gt;</em>, <em>dropout=0.3</em>, <em>residual_connections=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/opennmt/decoders/rnn_decoder.html#MultiAttentionalRNNDecoder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#opennmt.decoders.rnn_decoder.MultiAttentionalRNNDecoder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the decoder parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_layers</strong> – The number of layers.</li>
<li><strong>num_units</strong> – The number of units in each layer.</li>
<li><strong>attention_layers</strong> – A list of integers, the layers after which to add
attention. If <code class="docutils literal"><span class="pre">None</span></code>, attention will only be added after the last
layer.</li>
<li><strong>attention_mechanism_class</strong> – A class or list of classes inheriting from
<code class="docutils literal"><span class="pre">tf.contrib.seq2seq.AttentionMechanism</span></code>. Alternatively, the class can
be replaced by a callable that takes
<code class="docutils literal"><span class="pre">(num_units,</span> <span class="pre">memory,</span> <span class="pre">memory_sequence_length)</span></code> as arguments and returns
a <code class="docutils literal"><span class="pre">tf.contrib.seq2seq.AttentionMechanism</span></code>.</li>
<li><strong>cell_class</strong> – The inner cell class or a callable taking <code class="xref py py-obj docutils literal"><span class="pre">num_units</span></code> as
argument and returning a cell.</li>
<li><strong>dropout</strong> – The probability to drop units in each layer output.</li>
<li><strong>residual_connections</strong> – If <code class="docutils literal"><span class="pre">True</span></code>, each layer input will be added to its
output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="opennmt.decoders.self_attention_decoder.html" class="btn btn-neutral float-right" title="opennmt.decoders.self_attention_decoder module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="opennmt.decoders.decoder.html" class="btn btn-neutral" title="opennmt.decoders.decoder module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: v1.3.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../v1.8.0/package/opennmt.decoders.rnn_decoder.html">v1.8.0</a></dd>
            <dd><a href="../../v1.7.0/package/opennmt.decoders.rnn_decoder.html">v1.7.0</a></dd>
            <dd><a href="../../v1.6.0/package/opennmt.decoders.rnn_decoder.html">v1.6.0</a></dd>
            <dd><a href="../../v1.5.0/package/opennmt.decoders.rnn_decoder.html">v1.5.0</a></dd>
            <dd><a href="../../v1.4.0/package/opennmt.decoders.rnn_decoder.html">v1.4.0</a></dd>
            <dd><a href="opennmt.decoders.rnn_decoder.html">v1.3.0</a></dd>
            <dd><a href="../../v1.2.0/package/opennmt.decoders.rnn_decoder.html">v1.2.0</a></dd>
            <dd><a href="../../v1.1.0/package/opennmt.decoders.rnn_decoder.html">v1.1.0</a></dd>
            <dd><a href="../../v1.0.0/package/opennmt.decoders.rnn_decoder.html">v1.0.0</a></dd>
        </dl>
    </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>